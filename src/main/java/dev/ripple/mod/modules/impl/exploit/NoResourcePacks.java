package dev.ripple.mod.modules.impl.exploit;

import dev.ripple.api.events.eventbus.EventHandler;
import dev.ripple.api.events.impl.PacketEvent;
import dev.ripple.mod.modules.Module;
import net.minecraft.network.packet.c2s.common.ResourcePackStatusC2SPacket;
import net.minecraft.network.packet.s2c.common.ResourcePackSendS2CPacket;

public class NoResourcePacks extends Module {
    public static NoResourcePacks INSTANCE;
    boolean send = false;

    public NoResourcePacks() {
        super("NoResourcePacks", Category.Exploit);
        INSTANCE = this;
    }

    @Override
    public void onUpdate() {
        if (send && mc.player != null) {
            mc.getNetworkHandler().sendPacket(new ResourcePackStatusC2SPacket(mc.player.getUuid(), ResourcePackStatusC2SPacket.Status.ACCEPTED));
            mc.getNetworkHandler().sendPacket(new ResourcePackStatusC2SPacket(mc.player.getUuid(), ResourcePackStatusC2SPacket.Status.DOWNLOADED));
            mc.getNetworkHandler().sendPacket(new ResourcePackStatusC2SPacket(mc.player.getUuid(), ResourcePackStatusC2SPacket.Status.SUCCESSFULLY_LOADED));
            send = false;
        }
    }

    @EventHandler
    public void onPacketReceive(PacketEvent.Receive event) {
        if (event.getPacket() instanceof ResourcePackSendS2CPacket) {
            send = true;
            event.cancel();
        }
    }
}