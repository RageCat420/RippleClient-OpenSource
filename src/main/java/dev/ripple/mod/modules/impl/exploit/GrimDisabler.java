package dev.ripple.mod.modules.impl.exploit;

import dev.ripple.api.events.eventbus.EventHandler;
import dev.ripple.api.events.impl.PacketEvent;
import dev.ripple.asm.accessors.IPlayerPositionLookS2CPacket;
import dev.ripple.mod.modules.Module;
import net.minecraft.network.packet.s2c.play.PlayerPositionLookS2CPacket;
import net.minecraft.network.packet.s2c.play.PositionFlag;

public class GrimDisabler extends Module {
    public static GrimDisabler INSTANCE;

    public GrimDisabler() {
        super("GrimDisabler", Category.Exploit);
        setChinese("Grim绕过");
        INSTANCE = this;
    }

    @EventHandler
    public void onPacketReceive(PacketEvent.Receive event) {
        if (nullCheck()) return;
        if (event.getPacket() instanceof PlayerPositionLookS2CPacket packet) {
            ((IPlayerPositionLookS2CPacket) packet).setYaw(mc.player.getYaw());
            ((IPlayerPositionLookS2CPacket) packet).setPitch(mc.player.getPitch());
            packet.getFlags().remove(PositionFlag.X_ROT);
            packet.getFlags().remove(PositionFlag.Y_ROT);
        }
    }
}